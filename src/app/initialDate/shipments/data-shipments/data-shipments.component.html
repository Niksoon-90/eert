<div class="p-mb-3" style="margin: 20px 0 0 0 !important;">
  <p-button type="button" icon="pi pi-chevron-left" (click)="prev()" [disabled]="isFirstPage()" styleClass="p-button-text"></p-button>
  <p-button type="button" icon="pi pi-refresh" (click)="reset()" styleClass="p-button-text" pTooltip="Обновить" tooltipPosition="bottom"></p-button>
  <p-button type="button" icon="pi pi-chevron-right" (click)="next()" [disabled]="isLastPage()" styleClass="p-button-text"></p-button>
</div>
<p-table [value]="shipmentsSession" styleClass="p-datatable-sm p-datatable-gridlines" [paginator]="true" [rows]="rows"
         [showCurrentPageReport]="true" [(first)]="first"
         currentPageReportTemplate=" {first} из {last}  ({totalRecords})" [rowsPerPageOptions]="[25,50]" dataKey="id"
         [resizableColumns]="true">

  <ng-template pTemplate="colgroup" let-columns>
    <colgroup>
      <col style="width:80px">
      <col>
      <col>
      <col>
      <col>
      <col>
      <col style="width:100px">
    </colgroup>
  </ng-template>
  <ng-template pTemplate="header">
    <tr >
      <th pResizableColumn pSortableColumn="id">id<p-sortIcon field="id"></p-sortIcon></th>
      <th pResizableColumn pSortableColumn="name">Наименование<p-sortIcon field="name"></p-sortIcon></th>
      <th pResizableColumn pSortableColumn="year">Года<p-sortIcon field="year"></p-sortIcon></th>
      <th pResizableColumn pSortableColumn="userLoginAdd">Логин<p-sortIcon field="userLoginAdd"></p-sortIcon></th>
      <th pResizableColumn pSortableColumn="userFioAdd">ФИО<p-sortIcon field="userFioAdd"></p-sortIcon></th>
      <th pResizableColumn pSortableColumn="dateWrite">Дата загрузки<p-sortIcon field="endDate"></p-sortIcon></th>
      <th> Действия</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-itemShipmentsSession >
    <tr>
      <td>{{itemShipmentsSession.id}}</td>
      <td>{{itemShipmentsSession.name}}</td>
      <td>{{itemShipmentsSession.year}}</td>
      <td>{{itemShipmentsSession.userLoginAdd}}</td>
      <td>{{itemShipmentsSession.userFioAdd}}</td>
      <td>{{itemShipmentsSession.dateWrite | date:'full' }}</td>
      <td>
        <button pButton pRipple type="button" icon="pi pi-pencil" pTooltip="Редактировать" tooltipPosition="bottom" class="p-button-rounded p-button-success p-mr-2 p-button p-component p-button-icon-only" (click)="openShipItemSession(itemShipmentsSession.id)"></button>
        <button pButton pRipple type="button" icon="pi pi-trash" pTooltip="Удалить" tooltipPosition="bottom" class="p-button-rounded p-button-warning p-button p-component p-button-icon-only" (click)="removeShipSession(itemShipmentsSession.id)"></button>
      </td>
    </tr>
  </ng-template>
</p-table>

<div class="card">

  <p-dialog header="Загруженные данные" [(visible)]="dialogVisible" [style]="{width: '50vw'}" [baseZIndex]="10000" [maximizable]="true" [modal]="true" [resizable]="true" [contentStyle]="{height: '300px'}" >
    <p-table #dt [value]="shipmentsListSessionId" [scrollable]="true" scrollHeight="flex" scrollHeight="70vh" [filterDelay]="0" styleClass="p-datatable-sm p-datatable-gridlines" [resizableColumns]="true" columnResizeMode="expand" >
      <ng-template pTemplate="colgroup" let-columns>
        <colgroup>
          <col style="width:80px">
          <col style="width:100px">
          <col style="width:200px">
          <col style="width:200px">
          <col style="width:200px">
          <col style="width:200px">
          <col style="width:250px">
          <col style="width:250px">
          <col style="width:200px">
          <col style="width:200px">
          <col style="width:200px">
          <col style="width:250px">
          <col style="width:250px">
          <ng-container *ngIf="shipmentsListSessionId">
            <col style="width:100px" *ngFor="let data of shipmentsListSessionId[0].shipmentYearValuePairs">
          </ng-container>
          <col style="width:150px">
        </colgroup>
      </ng-template>
      <ng-template pTemplate="header" >
        <tr>
          <th>№_п.п.</th>
          <th pResizableColumn pSortableColumn="cargoGroup">Группа груза<p-sortIcon field="cargoGroup"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="shipmentType">Вид перевозки<p-sortIcon field="shipmentType"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="primary">Основные<p-sortIcon field="primary"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="fromRoad">Дорога отправления<p-sortIcon field="fromRoad"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="fromStation">Станция отправления РФ<p-sortIcon field="fromStation"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="fromStationCode">Код станции отправления РФ<p-sortIcon field="fromStationCode"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="senderName">Субъект отправления<p-sortIcon field="senderName"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="receiverName">Грузоотправитель<p-sortIcon field="receiverName"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="toRoad">Дорога назначения<p-sortIcon field="toRoad"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="toStation">Станция назначения РФ<p-sortIcon field="toStation"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="toStationCode">Код станции назначения РФ<p-sortIcon field="toStationCode"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="toSubject">Субъект назначения<p-sortIcon field="toSubject"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="receiverName">Грузополучатель<p-sortIcon field="receiverName"></p-sortIcon></th>
          <ng-container *ngIf="shipmentsListSessionId">
            <th pResizableColumn *ngFor="let data of shipmentsListSessionId[0].shipmentYearValuePairs">
              {{data.year}}
            </th>
          </ng-container>
          <th>Действия</th>
        </tr>
        <tr>
          <th colspan="2">
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'cargoGroup', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'shipmentType', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <p-dropdown [options]="typePrimary" (onChange)="dt.filter($event.value, 'primary', 'equals')" styleClass="p-column-filter" placeholder="Select a Status" [showClear]="true">
              <ng-template let-option pTemplate="item">
                <span [class]="'customer-badge primary-' + option.value">{{option.label}}</span>
              </ng-template>
            </p-dropdown>
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'fromRoad', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'fromStation', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'fromStationCode', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'senderName', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'receiverName', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'toRoad', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'toStation', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'toStationCode', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'toSubject', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>
          <th>
            <input pInputText type="text" (input)="dt.filter($event.target.value, 'receiverName', 'contains')" placeholder="Фильтр" class="p-column-filter">
          </th>



          <ng-container *ngFor="let data of shipmentsListSessionId[0].shipmentYearValuePairs; let i = index">
            <th>
              <p>data.value</p>
              <input pInputText type="text" (input)="dt.filter($event.target.value, 'data.value', 'contains')" placeholder="Фильтр" class="p-column-filter">
            </th>
          </ng-container>

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item let-ri="rowIndex">
        <tr>
          <td>{{ri}}</td>
          <td>{{item.cargoGroup}}</td>
          <td>{{item.shipmentType}}</td>
          <td *ngIf="item.primary === true">да</td>
          <td *ngIf="item.primary === false">нет</td>
          <td>{{item.fromRoad}}</td>
          <td>{{item.fromStation}}</td>
          <td>{{item.fromStationCode}}</td>
          <td>{{item.senderName}}</td>
          <td>{{item.receiverName}}</td>
          <td>{{item.toRoad}}</td>
          <td>{{item.toStation}}</td>
          <td>{{item.toStationCode}}</td>
          <td>{{item.toSubject}}</td>
          <td>{{item.receiverName}}</td>
          <td *ngFor="let data of item.shipmentYearValuePairs">
            {{data.value | number }}
          </td>
        <td>
          <button pButton pRipple type="button" icon="pi pi-pencil" pTooltip="Редактировать" tooltipPosition="bottom" class="p-button-rounded p-button-success p-mr-2 p-button p-component p-button-icon-only"></button>
          <button pButton pRipple type="button" icon="pi pi-trash" pTooltip="Удалить" tooltipPosition="bottom" class="p-button-rounded p-button-warning p-button p-component p-button-icon-only"></button>
        </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <tr>
          <td colspan="13" class="p-text-right">Итого: </td>
          <td *ngFor="let items of this.massSummYears">{{items | number}}</td>
        </tr>
      </ng-template>
    </p-table>
    <ng-template pTemplate="footer">
      <button type="button" pButton pRipple icon="pi pi-times" (click)="dialogVisible=false" label="Закрыть" class="p-button-text"></button>
    </ng-template>
  </p-dialog>
  </div>

